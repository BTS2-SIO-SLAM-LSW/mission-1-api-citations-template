<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üìä √âvaluation Mission 1</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            font-family: system-ui, sans-serif; 
            background: #f8fafc; 
            padding: 1rem; 
            line-height: 1.6;
        }
        .container { 
            max-width: 900px; 
            margin: 0 auto; 
            background: white; 
            border-radius: 12px; 
            box-shadow: 0 4px 6px rgba(0,0,0,0.1); 
        }
        .header { 
            background: linear-gradient(135deg, #3b82f6, #1e40af); 
            color: white; 
            padding: 2rem; 
            text-align: center; 
            border-radius: 12px 12px 0 0; 
        }
        .header h1 { font-size: 2rem; margin-bottom: 0.5rem; }
        .content { padding: 2rem; }
        .section { 
            margin-bottom: 2rem; 
            padding: 1.5rem; 
            background: #f9fafb; 
            border-radius: 8px; 
        }
        .section h2 { 
            color: #1f2937; 
            margin-bottom: 1rem; 
            font-size: 1.25rem; 
        }
        .section h3 {
            color: #3b82f6; 
            margin: 1.5rem 0 1rem 0;
            font-size: 1.1rem;
        }
        .alert { 
            background: #dbeafe; 
            color: #1e40af; 
            padding: 1rem; 
            border-radius: 8px; 
            margin-bottom: 1rem;
            border-left: 4px solid #3b82f6;
        }
        .form-row { 
            display: grid; 
            grid-template-columns: 1fr 1fr; 
            gap: 1rem; 
            margin-bottom: 1rem; 
        }
        .form-group { margin-bottom: 1rem; }
        label { 
            display: block; 
            font-weight: 600; 
            margin-bottom: 0.5rem; 
            color: #374151; 
        }
        input, select, textarea { 
            width: 100%; 
            padding: 0.75rem; 
            border: 2px solid #e5e7eb; 
            border-radius: 8px; 
            font-size: 1rem; 
            transition: border-color 0.2s;
        }
        input:focus, select:focus, textarea:focus { 
            outline: none; 
            border-color: #3b82f6; 
        }
        textarea { 
            min-height: 60px; 
            resize: vertical; 
        }
        .btn { 
            padding: 0.75rem 1.5rem; 
            background: #3b82f6; 
            color: white; 
            border: none; 
            border-radius: 8px; 
            font-weight: 600; 
            cursor: pointer; 
            transition: all 0.2s; 
        }
        .btn:hover { 
            background: #1e40af; 
            transform: translateY(-1px); 
        }
        .btn-success { background: #10b981; }
        .btn-success:hover { background: #059669; }
        .score { 
            background: #dbeafe; 
            padding: 1rem; 
            border-radius: 8px; 
            text-align: center; 
            font-weight: 700; 
            color: #1e40af; 
            margin-top: 1rem;
        }
        .checkbox-group { display: grid; gap: 0.5rem; }
        .checkbox-item { 
            display: flex; 
            align-items: center; 
            gap: 0.5rem; 
            padding: 0.5rem; 
            background: white; 
            border-radius: 6px; 
        }
        .checkbox-item input[type="checkbox"] { width: auto; }
        .qcm-question { 
            background: #f9fafb; 
            padding: 1rem; 
            border-radius: 8px; 
            margin-bottom: 1rem; 
            border: 1px solid #e5e7eb;
        }
        .qcm-question h4 { 
            color: #1f2937; 
            margin-bottom: 0.75rem; 
            font-size: 1rem; 
            line-height: 1.4;
        }
        .compact-options {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 0.25rem;
            margin: 0.5rem 0;
        }
        .radio-group { 
            display: grid; 
            gap: 0.25rem; 
            margin: 0.5rem 0; 
        }
        .radio-item { 
            display: flex; 
            align-items: center; 
            gap: 0.5rem; 
            padding: 0.5rem; 
            background: white; 
            border-radius: 6px; 
            cursor: pointer; 
            font-size: 0.9rem;
            border: 1px solid #e5e7eb;
            transition: all 0.2s;
        }
        .radio-item:hover { 
            background: #f0f9ff; 
            border-color: #3b82f6;
        }
        .radio-item input[type="radio"] { 
            width: auto; 
            margin-right: 0.5rem; 
        }
        .actions { 
            display: flex; 
            gap: 1rem; 
            justify-content: center; 
            padding: 2rem; 
            background: #f9fafb; 
            border-radius: 0 0 12px 12px; 
        }
        .json-output { 
            background: #1f2937; 
            color: #f9fafb; 
            padding: 1rem; 
            border-radius: 8px; 
            font-family: 'Courier New', monospace; 
            font-size: 0.875rem; 
            max-height: 300px; 
            overflow-y: auto; 
            white-space: pre-wrap; 
            margin-top: 1rem;
        }
        .etape-item {
            background: white;
            padding: 1rem;
            border-radius: 6px;
            margin-bottom: 1rem;
            border: 1px solid #e5e7eb;
        }
        .etape-item h4 {
            color: #1f2937;
            margin-bottom: 0.75rem;
            font-size: 1rem;
        }
        .concepts-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
        }
        @media (max-width: 768px) { 
            .form-row { grid-template-columns: 1fr; } 
            .actions { flex-direction: column; }
            .compact-options { grid-template-columns: 1fr; }
            .concepts-grid { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üìä √âvaluation Mission 1</h1>
            <p>G√©n√©rateur de Citations avec API REST</p>
        </div>

        <div class="content">
            <!-- Info Section -->
            <div class="alert">
                <strong>‚ÑπÔ∏è Information :</strong> Les informations √©tudiant (nom, pr√©nom, repository) seront automatiquement remplies lors de la g√©n√©ration du JSON par le script de collecte.
            </div>

            <!-- Section QCM -->
            <div class="section">
                <h2>üìö Questionnaire (QCM)</h2>
                <div id="qcm-container"></div>
            </div>

            <!-- Section Technique -->
            <div class="section">
                <h2>‚ö° Auto-√©valuation Technique</h2>
                <h3>üîß Fonctionnalit√©s Obligatoires (15 pts)</h3>
                <div class="checkbox-group" id="obligatoire-container"></div>
                
                <h3>üåü Fonctionnalit√©s Bonus (9 pts)</h3>
                <div class="checkbox-group" id="bonus-container"></div>
                
                <div class="score" id="score-display">Score: 0/42 points (0/20)</div>
            </div>

            <!-- Section Progression -->
            <div class="section">
                <h2>üìà Auto-√©valuation de Progression</h2>
                
                <h3>üéØ √âtapes Compl√©t√©es</h3>
                <div id="etapes-container"></div>
                
                <h3>üí° Concepts Ma√Ætris√©s</h3>
                <div class="concepts-grid" id="concepts-container"></div>
                
                <div class="form-group">
                    <label>Concepts √† revoir</label>
                    <textarea id="concepts_a_revoir" placeholder="Listez les concepts que vous souhaitez approfondir (s√©par√©s par des virgules)..."></textarea>
                </div>
                
                <div class="form-group">
                    <label>Difficult√©s rencontr√©es</label>
                    <textarea id="difficultes_rencontrees" placeholder="D√©crivez les principales difficult√©s rencontr√©es..."></textarea>
                </div>

                <div class="form-group">
                    <label>Points forts identifi√©s</label>
                    <textarea id="points_forts_identifies" placeholder="Quels sont vos points forts dans cet exercice ?"></textarea>
                </div>

                <div class="form-group">
                    <label>Am√©liorations souhait√©es</label>
                    <textarea id="ameliorations_souhaitees" placeholder="Sur quoi aimeriez-vous progresser ?"></textarea>
                </div>
            </div>

            <!-- Section R√©flexion -->
            <div class="section">
                <h2>üí≠ R√©flexion P√©dagogique</h2>
                
                <div class="form-row">
                    <div class="form-group">
                        <label>Temps total n√©cessaire</label>
                        <select id="temps_total_necessaire">
                            <option value="">S√©lectionner...</option>
                            <option value="< 30 min">< 30 minutes</option>
                            <option value="30-60 min">30-60 minutes</option>
                            <option value="60-90 min">60-90 minutes</option>
                            <option value="90-120 min">90-120 minutes</option>
                            <option value="> 120 min">> 120 minutes</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Niveau de satisfaction</label>
                        <select id="niveau_satisfaction">
                            <option value="">S√©lectionner...</option>
                            <option value="Tr√®s insatisfait">Tr√®s insatisfait</option>
                            <option value="Insatisfait">Insatisfait</option>
                            <option value="Neutre">Neutre</option>
                            <option value="Satisfait">Satisfait</option>
                            <option value="Tr√®s satisfait">Tr√®s satisfait</option>
                        </select>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label>√âtape la plus difficile</label>
                        <select id="etape_la_plus_difficile">
                            <option value="">S√©lectionner...</option>
                            <option value="Configuration initiale">Configuration initiale</option>
                            <option value="Appel API">Appel API</option>
                            <option value="Manipulation DOM">Manipulation DOM</option>
                            <option value="Gestion d'erreurs">Gestion d'erreurs</option>
                            <option value="CSS Responsive">CSS Responsive</option>
                            <option value="Git/GitHub">Git/GitHub</option>
                            <option value="GitHub Pages">GitHub Pages</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>√âtape la plus int√©ressante</label>
                        <select id="etape_la_plus_interessante">
                            <option value="">S√©lectionner...</option>
                            <option value="D√©couverte API">D√©couverte API</option>
                            <option value="JavaScript asynchrone">JavaScript asynchrone</option>
                            <option value="Design CSS">Design CSS</option>
                            <option value="Interactivit√©">Interactivit√©</option>
                            <option value="D√©ploiement">D√©ploiement</option>
                            <option value="Gestion d'erreurs">Gestion d'erreurs</option>
                        </select>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label>Utilit√© des commentaires dans le code</label>
                        <select id="utilite_des_commentaires">
                            <option value="">√âvaluer...</option>
                            <option value="Inutiles">Inutiles</option>
                            <option value="Peu utiles">Peu utiles</option>
                            <option value="Utiles">Utiles</option>
                            <option value="Tr√®s utiles">Tr√®s utiles</option>
                            <option value="Indispensables">Indispensables</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Clart√© des instructions</label>
                        <select id="clarte_des_instructions">
                            <option value="">√âvaluer...</option>
                            <option value="Tr√®s confuses">Tr√®s confuses</option>
                            <option value="Confuses">Confuses</option>
                            <option value="Correctes">Correctes</option>
                            <option value="Claires">Claires</option>
                            <option value="Tr√®s claires">Tr√®s claires</option>
                        </select>
                    </div>
                </div>

                <div class="form-group">
                    <label>Recommanderiez-vous cet exercice ?</label>
                    <select id="recommanderiez_exercice">
                        <option value="">S√©lectionner...</option>
                        <option value="Certainement pas">Certainement pas</option>
                        <option value="Probablement pas">Probablement pas</option>
                        <option value="Peut-√™tre">Peut-√™tre</option>
                        <option value="Probablement">Probablement</option>
                        <option value="Certainement">Certainement</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label>Suggestions d'am√©lioration</label>
                    <textarea id="suggestions_amelioration" placeholder="Comment pourrait-on am√©liorer cet exercice ?"></textarea>
                </div>
            </div>

            <!-- Section M√©ta-donn√©es -->
            <div class="section">
                <h2>üìã Informations d'√âvaluation</h2>
                <div class="form-row">
                    <div class="form-group">
                        <label>Dur√©e de l'√©valuation (minutes)</label>
                        <input type="number" id="duree_evaluation" placeholder="Temps pass√© en minutes" min="1" max="300">
                    </div>
                    <div class="form-group">
                        <label>Type d'√©valuateur</label>
                        <select id="evaluateur">
                            <option value="Auto-√©valuation √©tudiant">Auto-√©valuation √©tudiant</option>
                            <option value="√âvaluation formateur">√âvaluation formateur</option>
                            <option value="√âvaluation mixte">√âvaluation mixte</option>
                        </select>
                    </div>
                </div>

                <div class="form-group">
                    <label>Outils utilis√©s</label>
                    <div class="checkbox-group" id="outils-container"></div>
                </div>

                <div class="form-group">
                    <label>Observations g√©n√©rales</label>
                    <textarea id="observations" placeholder="Observations sur le d√©roulement de l'√©valuation..."></textarea>
                </div>
            </div>

            <!-- Section Export -->
            <div class="section">
                <h2>üíæ Export du JSON</h2>
                <div class="json-output" id="json-output">Cliquez sur "G√©n√©rer JSON" pour voir le r√©sultat...</div>
            </div>
        </div>

        <div class="actions">
            <button onclick="generateJSON()" class="btn">üîÑ G√©n√©rer JSON</button>
            <button onclick="copyJSON()" class="btn btn-success">üìã Copier JSON</button>
        </div>
    </div>

    <script>
        // Configuration des donn√©es
        const QCM_DATA = {
            debutant: [
                {q: "Quelle m√©thode JavaScript permet de faire un appel API asynchrone moderne ?", options: ["fetch()", "call()", "request()", "api()"], correct: "fetch()", pts: 1},
                {q: "Que signifie l'acronyme API ?", options: ["Application Programming Interface", "Automated Program Interface", "Advanced Programming Interface", "Application Process Interface"], correct: "Application Programming Interface", pts: 1},
                {q: "Comment r√©cup√®re-t-on un √©l√©ment HTML par son ID en JavaScript ?", options: ["document.getElementById('monId')", "document.getElement('monId')", "getElementById('monId')", "document.find('#monId')"], correct: "document.getElementById('monId')", pts: 1}
            ],
            intermediaire: [
                {q: "Comment g√®re-t-on une erreur avec la m√©thode fetch() ?", options: ["try...catch avec async/await", "error() callback", "fail() method", "exception handler"], correct: "try...catch avec async/await", pts: 2},
                {q: "Quelle balise HTML est s√©mantiquement correcte pour afficher une citation ?", options: ["<blockquote>", "<cite>", "<quote>", "<div class='citation'>"], correct: "<blockquote>", pts: 2},
                {q: "Que fait la commande 'git push origin main' ?", options: ["Envoie les commits locaux vers le repository distant", "R√©cup√®re les modifications du serveur", "Cr√©e une nouvelle branche main", "Supprime les fichiers du repository"], correct: "Envoie les commits locaux vers le repository distant", pts: 2}
            ],
            avance: [
                {q: "Que retourne l'API quotable.io dans sa r√©ponse ?", options: ["Un objet JSON avec les propri√©t√©s content, author et length", "Du texte brut sans formatage", "Un fichier XML structur√©", "Une image avec le texte de la citation"], correct: "Un objet JSON avec les propri√©t√©s content, author et length", pts: 3},
                {q: "Quelle est la diff√©rence principale entre .then() et async/await ?", options: ["async/await offre une syntaxe plus lisible pour le code asynchrone", ".then() est plus performant", "async/await ne g√®re pas les erreurs", "Il n'y a aucune diff√©rence fonctionnelle"], correct: "async/await offre une syntaxe plus lisible pour le code asynchrone", pts: 3},
                {q: "Pourquoi utilise-t-on textContent plut√¥t que innerHTML pour afficher du texte utilisateur ?", options: ["Pour √©viter les injections XSS et les failles de s√©curit√©", "textContent est plus rapide", "innerHTML ne fonctionne pas avec du texte", "C'est une pr√©f√©rence de style de code"], correct: "Pour √©viter les injections XSS et les failles de s√©curit√©", pts: 3}
            ]
        };

        const TECH_DATA = {
            obligatoire: [
                {id: "appel_api_fonctionnel", label: "Appel API fonctionnel", pts: 3},
                {id: "affichage_citation", label: "Affichage citation et auteur", pts: 2},
                {id: "gestion_erreurs", label: "Gestion des erreurs", pts: 3},
                {id: "design_responsive", label: "Design responsive", pts: 2},
                {id: "interactivite_bouton", label: "Bouton nouvelle citation", pts: 2},
                {id: "github_pages_deploye", label: "GitHub Pages d√©ploy√©", pts: 3}
            ],
            bonus: [
                {id: "partage_social", label: "Partage social", pts: 2},
                {id: "favoris_localstorage", label: "Favoris localStorage", pts: 3},
                {id: "animations_css", label: "Animations CSS", pts: 1},
                {id: "raccourcis_clavier", label: "Raccourcis clavier", pts: 1},
                {id: "accessibilite", label: "Accessibilit√©", pts: 2}
            ]
        };

        const ETAPES_DATA = [
            {id: "etape_1_appel_api", label: "√âtape 1: Appel API"},
            {id: "etape_2_affichage_dom", label: "√âtape 2: Affichage DOM"},
            {id: "etape_3_gestion_erreurs", label: "√âtape 3: Gestion d'erreurs"},
            {id: "etape_4_evenements", label: "√âtape 4: √âv√©nements"}
        ];

        const CONCEPTS_DATA = [
            {id: "fetch_api", label: "Fetch API"},
            {id: "async_await", label: "Async/Await"},
            {id: "manipulation_dom", label: "Manipulation DOM"},
            {id: "gestion_erreurs", label: "Gestion d'erreurs"},
            {id: "event_listeners", label: "Event Listeners"},
            {id: "git_github", label: "Git/GitHub"},
            {id: "html_semantique", label: "HTML S√©mantique"},
            {id: "css_responsive", label: "CSS Responsive"}
        ];

        const OUTILS_DATA = [
            {id: "formulaire_web", label: "Formulaire web interactif"},
            {id: "editeur_code", label: "√âditeur de code (VS Code, etc.)"},
            {id: "navigateur_dev", label: "Outils d√©veloppeur navigateur"},
            {id: "github_desktop", label: "GitHub Desktop"},
            {id: "terminal", label: "Terminal/Ligne de commande"},
            {id: "documentation", label: "Documentation en ligne"},
            {id: "stack_overflow", label: "Stack Overflow"},
            {id: "youtube", label: "Tutoriels YouTube"},
            {id: "aide_formateur", label: "Aide du formateur"},
            {id: "entraide_etudiants", label: "Entraide entre √©tudiants"}
        ];

        // Initialisation
        document.addEventListener('DOMContentLoaded', function() {
            generateQCM();
            generateTechnical();
            generateEtapes();
            generateConcepts();
            generateOutils();
            loadData();
            document.addEventListener('input', saveData);
            document.addEventListener('change', updateScore);
        });

        // G√©n√©ration dynamique du QCM avec affichage compact
        function generateQCM() {
            const container = document.getElementById('qcm-container');
            let html = '';
            let qIndex = 1;

            Object.entries(QCM_DATA).forEach(([level, questions]) => {
                const levelName = level.charAt(0).toUpperCase() + level.slice(1);
                const totalPts = questions.reduce((sum, q) => sum + q.pts, 0);
                html += `<h3>${levelName} (${totalPts} pts)</h3>`;
                
                questions.forEach((question, i) => {
                    // D√©tection intelligente pour affichage compact
                    const isLongOptions = question.options.some(opt => opt.length > 30);
                    const gridClass = isLongOptions ? 'radio-group' : 'compact-options';
                    
                    html += `<div class="qcm-question">
                        <h4>Q${qIndex}. ${question.q} <span style="color: #6b7280;">(${question.pts} pt${question.pts>1?'s':''})</span></h4>
                        <div class="${gridClass}">`;
                    
                    question.options.forEach(option => {
                        html += `<label class="radio-item">
                            <input type="radio" name="q${qIndex}" value="${option}"> 
                            <span style="flex: 1;">${option}</span>
                        </label>`;
                    });
                    
                    html += `</div>
                        <textarea id="q${qIndex}_justification" placeholder="Justification (optionnel)..." style="margin-top: 0.5rem;"></textarea>
                    </div>`;
                    qIndex++;
                });
            });
            container.innerHTML = html;
        }

        // G√©n√©ration des checkboxes techniques
        function generateTechnical() {
            ['obligatoire', 'bonus'].forEach(type => {
                const container = document.getElementById(`${type}-container`);
                container.innerHTML = TECH_DATA[type].map(item => 
                    `<label class="checkbox-item">
                        <input type="checkbox" id="${item.id}"> 
                        <strong>${item.label}</strong> (${item.pts} pt${item.pts>1?'s':''})
                    </label>`
                ).join('');
            });
        }

        // G√©n√©ration des √©tapes de progression
        function generateEtapes() {
            const container = document.getElementById('etapes-container');
            container.innerHTML = ETAPES_DATA.map(etape => 
                `<div class="etape-item">
                    <h4>${etape.label}</h4>
                    <label class="checkbox-item">
                        <input type="checkbox" id="${etape.id}_terminee"> √âtape termin√©e
                    </label>
                    <div class="form-row">
                        <div class="form-group">
                            <label>Difficult√© per√ßue</label>
                            <select id="${etape.id}_difficulte_per√ßue">
                                <option value="">S√©lectionner...</option>
                                <option value="Tr√®s facile">Tr√®s facile</option>
                                <option value="Facile">Facile</option>
                                <option value="Moyen">Moyen</option>
                                <option value="Difficile">Difficile</option>
                                <option value="Tr√®s difficile">Tr√®s difficile</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Temps pass√©</label>
                            <select id="${etape.id}_temps_passe">
                                <option value="">S√©lectionner...</option>
                                <option value="< 5 min">< 5 minutes</option>
                                <option value="5-15 min">5-15 minutes</option>
                                <option value="15-30 min">15-30 minutes</option>
                                <option value="30-60 min">30-60 minutes</option>
                                <option value="> 60 min">> 60 minutes</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Aide n√©cessaire</label>
                        <textarea id="${etape.id}_aide_necessaire" placeholder="Documentation, recherches, aide du formateur..."></textarea>
                    </div>
                </div>`
            ).join('');
        }

        // G√©n√©ration des concepts ma√Ætris√©s
        function generateConcepts() {
            const container = document.getElementById('concepts-container');
            container.innerHTML = CONCEPTS_DATA.map(concept => 
                `<div class="form-group">
                    <label>${concept.label}</label>
                    <select id="${concept.id}">
                        <option value="">Auto-√©valuation...</option>
                        <option value="Non ma√Ætris√©">Non ma√Ætris√©</option>
                        <option value="Partiellement ma√Ætris√©">Partiellement ma√Ætris√©</option>
                        <option value="Bien ma√Ætris√©">Bien ma√Ætris√©</option>
                        <option value="Parfaitement ma√Ætris√©">Parfaitement ma√Ætris√©</option>
                    </select>
                </div>`
            ).join('');
        }

        // G√©n√©ration des outils utilis√©s
        function generateOutils() {
            const container = document.getElementById('outils-container');
            container.innerHTML = OUTILS_DATA.map(outil => 
                `<label class="checkbox-item">
                    <input type="checkbox" id="${outil.id}"> ${outil.label}
                </label>`
            ).join('');
        }

        // Calcul du score
        function updateScore() {
            let total = 0;
            
            // Score QCM
            let qIndex = 1;
            Object.values(QCM_DATA).flat().forEach(question => {
                const selected = document.querySelector(`input[name="q${qIndex}"]:checked`);
                if (selected && selected.value === question.correct) total += question.pts;
                qIndex++;
            });
            
            // Score technique
            [...TECH_DATA.obligatoire, ...TECH_DATA.bonus].forEach(item => {
                const checkbox = document.getElementById(item.id);
                if (checkbox && checkbox.checked) total += item.pts;
            });
            
            const note20 = Math.round(total * 20 / 42);
            document.getElementById('score-display').textContent = `Score: ${total}/42 points (${note20}/20)`;
        }

        // G√©n√©ration JSON
        function generateJSON() {
            const data = {
                etudiant: {
                    nom: "[√Ä REMPLIR PAR SCRIPT]",
                    prenom: "[√Ä REMPLIR PAR SCRIPT]", 
                    classe: "BTS2-SIO-SLAM",
                    date: "[√Ä REMPLIR PAR SCRIPT]",
                    duree_seance: "60min",
                    github_repository: "[√Ä REMPLIR PAR SCRIPT]",
                    github_pages_url: "[√Ä REMPLIR PAR SCRIPT]"
                },
                qcm_niveau_debutant: {},
                qcm_niveau_intermediaire: {},
                qcm_niveau_avance: {},
                evaluation_technique: {
                    fonctionnalites_implementees: {},
                    bonus_optionnels: {}
                }
            };

            // QCM
            let qIndex = 1;
            Object.entries(QCM_DATA).forEach(([level, questions]) => {
                const sectionKey = `qcm_niveau_${level}`;
                questions.forEach((question, i) => {
                    const selected = document.querySelector(`input[name="q${qIndex}"]:checked`);
                    const justification = document.getElementById(`q${qIndex}_justification`);
                    
                    data[sectionKey][`q${qIndex}`] = {
                        question: question.q,
                        reponse: selected ? selected.value : '',
                        options: question.options,
                        justification: justification ? justification.value : '',
                        points: question.pts,
                        concept: level === 'debutant' ? 'API/DOM' : level === 'intermediaire' ? 'JavaScript/Git' : 'S√©curit√©/API'
                    };
                    qIndex++;
                });
            });

            // Technique
            TECH_DATA.obligatoire.forEach(item => {
                const checkbox = document.getElementById(item.id);
                data.evaluation_technique.fonctionnalites_implementees[item.id] = {
                    realise: checkbox ? checkbox.checked : false,
                    points: item.pts,
                    commentaire: ""
                };
            });

            TECH_DATA.bonus.forEach(item => {
                const checkbox = document.getElementById(item.id);
                data.evaluation_technique.bonus_optionnels[item.id] = {
                    realise: checkbox ? checkbox.checked : false,
                    points: item.pts,
                    commentaire: ""
                };
            });

            // Auto-√©valuation progression
            data.auto√©valuation_progression = {
                etapes_completees: {},
                concepts_maitrises: {},
                concepts_a_revoir: getValue('concepts_a_revoir').split(',').map(s => s.trim()).filter(s => s),
                difficultes_rencontrees: getValue('difficultes_rencontrees').split(',').map(s => s.trim()).filter(s => s),
                points_forts_identifies: getValue('points_forts_identifies').split(',').map(s => s.trim()).filter(s => s),
                ameliorations_souhaitees: getValue('ameliorations_souhaitees').split(',').map(s => s.trim()).filter(s => s)
            };

            // √âtapes compl√©t√©es
            ETAPES_DATA.forEach(etape => {
                data.auto√©valuation_progression.etapes_completees[etape.id] = {
                    terminee: getValue(`${etape.id}_terminee`),
                    difficulte_per√ßue: getValue(`${etape.id}_difficulte_per√ßue`),
                    temps_passe: getValue(`${etape.id}_temps_passe`),
                    aide_necessaire: getValue(`${etape.id}_aide_necessaire`)
                };
            });

            // Concepts ma√Ætris√©s
            CONCEPTS_DATA.forEach(concept => {
                data.auto√©valuation_progression.concepts_maitrises[concept.id] = getValue(concept.id);
            });

            // R√©flexion p√©dagogique
            data.reflexion_pedagogique = {
                temps_total_necessaire: getValue('temps_total_necessaire'),
                etape_la_plus_difficile: getValue('etape_la_plus_difficile'),
                etape_la_plus_interessante: getValue('etape_la_plus_interessante'),
                utilite_des_commentaires: getValue('utilite_des_commentaires'),
                clarte_des_instructions: getValue('clarte_des_instructions'),
                suggestions_amelioration: getValue('suggestions_amelioration'),
                niveau_satisfaction: getValue('niveau_satisfaction'),
                recommanderiez_exercice: getValue('recommanderiez_exercice')
            };

            // √âvaluation formateur (structure vide)
            data.evaluation_formateur = {
                qualite_code: {
                    organisation: "",
                    commentaires: "",
                    bonnes_pratiques: "",
                    note: ""
                },
                comprehension_concepts: {
                    api_rest: "",
                    javascript_asynchrone: "",
                    manipulation_dom: "",
                    note: ""
                },
                autonomie: {
                    recherche_solutions: "",
                    gestion_erreurs: "",
                    debugging: "",
                    note: ""
                },
                commentaires_generaux: "",
                points_a_ameliorer: [],
                felicitations: []
            };

            // Grille de notation
            data.grille_notation = {
                qcm_debutant: {
                    total_points: 3,
                    points_obtenus: calculateQCMScore('debutant')
                },
                qcm_intermediaire: {
                    total_points: 6,
                    points_obtenus: calculateQCMScore('intermediaire')
                },
                qcm_avance: {
                    total_points: 9,
                    points_obtenus: calculateQCMScore('avance')
                },
                technique_obligatoire: {
                    total_points: 15,
                    points_obtenus: calculateTechniqueScore('obligatoire')
                },
                bonus_optionnel: {
                    total_points: 9,
                    points_obtenus: calculateTechniqueScore('bonus')
                },
                note_finale: {
                    total_sur_20: calculateFinalScore(),
                    appreciation: getAppreciation(calculateTotalScore())
                }
            };

            // R√©cup√©rer les outils s√©lectionn√©s
            const outilsUtilises = OUTILS_DATA.filter(outil => {
                const checkbox = document.getElementById(outil.id);
                return checkbox && checkbox.checked;
            }).map(outil => outil.label);

            // M√©ta-√©valuation
            data.meta_evaluation = {
                date_evaluation: new Date().toISOString().split('T')[0],
                evaluateur: getValue('evaluateur'),
                duree_evaluation: getValue('duree_evaluation'),
                outils_utilises: outilsUtilises,
                observations: getValue('observations')
            };

            document.getElementById('json-output').textContent = JSON.stringify(data, null, 2);
            updateScore();
        }

        // Fonctions utilitaires
        function getValue(id) {
            const element = document.getElementById(id);
            if (!element) return '';
            return element.type === 'checkbox' ? element.checked : element.value;
        }

        function calculateQCMScore(niveau) {
            let qIndex = 1;
            let score = 0;
            
            Object.entries(QCM_DATA).forEach(([level, questions]) => {
                if (level === niveau) {
                    questions.forEach(question => {
                        const selected = document.querySelector(`input[name="q${qIndex}"]:checked`);
                        if (selected && selected.value === question.correct) score += question.pts;
                        qIndex++;
                    });
                } else {
                    qIndex += questions.length;
                }
            });
            
            return score;
        }

        function calculateTechniqueScore(type) {
            return TECH_DATA[type].reduce((total, item) => {
                const checkbox = document.getElementById(item.id);
                return total + (checkbox && checkbox.checked ? item.pts : 0);
            }, 0);
        }

        function calculateTotalScore() {
            let total = 0;
            let qIndex = 1;
            Object.values(QCM_DATA).flat().forEach(question => {
                const selected = document.querySelector(`input[name="q${qIndex}"]:checked`);
                if (selected && selected.value === question.correct) total += question.pts;
                qIndex++;
            });
            [...TECH_DATA.obligatoire, ...TECH_DATA.bonus].forEach(item => {
                const checkbox = document.getElementById(item.id);
                if (checkbox && checkbox.checked) total += item.pts;
            });
            return total;
        }

        function calculateFinalScore() {
            return Math.round(calculateTotalScore() * 20 / 42);
        }

        function getAppreciation(score) {
            const note20 = Math.round(score * 20 / 42);
            if (note20 >= 18) return "Excellent";
            if (note20 >= 16) return "Tr√®s bien";
            if (note20 >= 14) return "Bien";
            if (note20 >= 12) return "Assez bien";
            if (note20 >= 10) return "Passable";
            return "Insuffisant";
        }

        function copyJSON() {
            const text = document.getElementById('json-output').textContent;
            if (!text || text.includes('Cliquez')) {
                alert('G√©n√©rez d\'abord le JSON !');
                return;
            }
            
            navigator.clipboard.writeText(text).then(() => {
                alert('‚úÖ JSON copi√© dans le presse-papiers !');
            }).catch(() => {
                alert('‚ùå Erreur de copie. S√©lectionnez manuellement le texte.');
            });
        }

        // Sauvegarde automatique (exclut les champs √©tudiant)
        function saveData() {
            const data = {};
            document.querySelectorAll('input, select, textarea').forEach(el => {
                if (el.id) {
                    if (el.type === 'checkbox') data[el.id] = el.checked;
                    else data[el.id] = el.value;
                }
                if (el.name && el.type === 'radio' && el.checked) data[el.name] = el.value;
            });
            localStorage.setItem('evaluation-data', JSON.stringify(data));
        }

        function loadData() {
            try {
                const data = JSON.parse(localStorage.getItem('evaluation-data') || '{}');
                Object.entries(data).forEach(([key, value]) => {
                    const el = document.getElementById(key) || document.querySelector(`input[name="${key}"]`);
                    if (el) {
                        if (el.type === 'checkbox') el.checked = value;
                        else if (el.type === 'radio' && el.value === value) el.checked = true;
                        else el.value = value;
                    }
                });
                updateScore();
            } catch (e) {
                console.warn('Erreur chargement localStorage:', e);
            }
        }
    </script>
</body>
</html>